package ipban

// Настройки системы IP-бана и логирования
var (
	// Максимальное количество уникальных IP-адресов, разрешенное для одного пользователя (конфига).
	// При превышении этого лимита, конфиг пользователя будет заблокирован.
	MAX_IPS_PER_CONFIG int

	// Полный путь к файлу access.log панели X-UI.
	// Этот файл используется для сбора информации о подключениях.
	ACCESS_LOG_PATH string

	// Путь к файлу, в который будут накапливаться логи из access.log.
	// Это необходимо, так как access.log может периодически очищаться или ротироваться.
	IP_ACCUMULATED_PATH string

	// Путь к файлу логов, куда система будет записывать все свои действия (баны, разбаны, ошибки).
	IP_BAN_LOG_PATH string

	// Интервал в минутах, с которым система будет проверять access.log на наличие новых записей
	// и добавлять их в накопленный лог (IP_ACCUMULATED_PATH).
	IP_SAVE_INTERVAL int

	// Основной интервал в минутах, с которым система будет анализировать накопленные логи
	// и проверять пользователей на предмет превышения лимита IP-адресов.
	IP_CHECK_INTERVAL int

	// Период ожидания в минутах перед фактическим отключением пользователя после обнаружения нарушения.
	// В текущей реализации это поле не используется, бан происходит немедленно.
	IP_BAN_GRACE_PERIOD int

	// Длительность бана пользователя в минутах.
	// По истечении этого времени пользователь будет автоматически разбанен.
	// Установите значение 0 для бессрочного бана.
	IP_BAN_DURATION int

	// Время в минутах, в течение которого система будет помнить IP-адреса пользователя.
	// Если IP-адрес не появлялся в логах дольше этого времени, он будет удален из счетчика.
	// Это помогает предотвратить накопление старых, неиспользуемых IP.
	IP_COUNTER_RETENTION int

	// Интервал в часах, с которым система будет проводить очистку старых данных
	// в накопленном лог-файле (IP_ACCUMULATED_PATH).
	IP_CLEANUP_INTERVAL int

	// Включает или отключает логирование забаненных пользователей.
	// Если установлено в true, информация о каждом забаненном пользователе будет записываться в лог.
	LOG_BANNED_USERS bool

	// Путь к файлу, в который будут записываться только логи о забаненных пользователях.
	BANNED_USERS_LOG_PATH string
)

// Инициализация настроек IP-бана и логирования
func init() {
	// Максимум IP на конфиг.
	MAX_IPS_PER_CONFIG = 4
	// Путь к access.log.
	ACCESS_LOG_PATH = "/usr/local/x-ui/access.log"
	// Путь к файлу накопленных логов.
	IP_ACCUMULATED_PATH = "/root/tools/ipBanSystem/logs/ip_accumulated.log"
	// Путь к логам IP бана.
	IP_BAN_LOG_PATH = "/root/tools/ipBanSystem/logs/ip_ban.log"
	// Интервал сохранения логов (минуты).
	// IP_SAVE_INTERVAL = 25
	IP_SAVE_INTERVAL = 1
	// Интервал проверки IP (минуты).
	// IP_CHECK_INTERVAL = 22
	IP_CHECK_INTERVAL = 1
	// Период ожидания перед баном (минуты).
	IP_BAN_GRACE_PERIOD = 10
	// Длительность бана (минуты).
	IP_BAN_DURATION = 120
	// Время хранения счетчиков IP (минуты).
	IP_COUNTER_RETENTION = 20
	// Интервал очистки старых логов (часы).
	IP_CLEANUP_INTERVAL = 3

	// Включает или отключает логирование забаненных пользователей.
	LOG_BANNED_USERS = true
	// Путь к логам забаненных пользователей.
	BANNED_USERS_LOG_PATH = "/root/tools/ipBanSystem/logs/ban.log"
}
